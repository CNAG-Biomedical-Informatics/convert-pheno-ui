/*! For license information please see 1347.22b584ae.chunk.js.LICENSE.txt */
(self.webpackChunkkeycloakify_starter=self.webpackChunkkeycloakify_starter||[]).push([[1347],{8926:function(e,t,r){e.exports=function(){var e=e||function(e,t){var n;if("undefined"!==typeof window&&window.crypto&&(n=window.crypto),"undefined"!==typeof self&&self.crypto&&(n=self.crypto),"undefined"!==typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!==typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&"undefined"!==typeof r.g&&r.g.crypto&&(n=r.g.crypto),!n)try{n=r(2480)}catch(v){}var i=function(){if(n){if("function"===typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(v){}if("function"===typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(v){}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),o={},a=o.lib={},u=a.Base={extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=a.WordArray=u.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var s=0;s<i;s++){var o=r[s>>>2]>>>24-s%4*8&255;t[n+s>>>2]|=o<<24-(n+s)%4*8}else for(var a=0;a<i;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=u.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(i());return new c.init(t,e)}}),l=o.enc={},d=l.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var s=t[i>>>2]>>>24-i%4*8&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new c.init(r,t/2)}},p=l.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var s=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new c.init(r,t)}},f=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},h=a.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,i=n.words,s=n.sigBytes,o=this.blockSize,a=s/(4*o),u=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*o,l=e.min(4*u,s);if(u){for(var d=0;d<u;d+=o)this._doProcessBlock(i,d);r=i.splice(0,u),n.sigBytes-=l}return new c.init(r,l)},clone:function(){var e=u.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),g=(a.Hasher=h.extend({cfg:u.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new g.HMAC.init(e,r).finalize(t)}}}),o.algo={});return o}(Math);return e}()},3713:function(e,t,r){!function(t,n){var i;e.exports=(i=r(8926),function(){var e=i,t=e.lib.WordArray;function r(e,r,n){for(var i=[],s=0,o=0;o<r;o++)if(o%4){var a=n[e.charCodeAt(o-1)]<<o%4*2|n[e.charCodeAt(o)]>>>6-o%4*2;i[s>>>2]|=a<<24-s%4*8,s++}return t.create(i,s)}e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var i=[],s=0;s<r;s+=3)for(var o=(t[s>>>2]>>>24-s%4*8&255)<<16|(t[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|t[s+2>>>2]>>>24-(s+2)%4*8&255,a=0;a<4&&s+.75*a<r;a++)i.push(n.charAt(o>>>6*(3-a)&63));var u=n.charAt(64);if(u)for(;i.length%4;)i.push(u);return i.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var s=0;s<n.length;s++)i[n.charCodeAt(s)]=s}var o=n.charAt(64);if(o){var a=e.indexOf(o);-1!==a&&(t=a)}return r(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),i.enc.Base64)}()},886:function(e,t,r){!function(t,n){var i;e.exports=(i=r(8926),i.enc.Utf8)}()},9517:function(e,t,r){!function(t,n){var i;e.exports=(i=r(8926),function(e){var t=i,r=t.lib,n=r.WordArray,s=r.Hasher,o=t.algo,a=[],u=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(a[i]=r(e.pow(n,.5))),u[i]=r(e.pow(n,1/3)),i++),n++}();var c=[],l=o.SHA256=s.extend({_doReset:function(){this._hash=new n.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],s=r[2],o=r[3],a=r[4],l=r[5],d=r[6],p=r[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var h=c[f-15],g=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,v=c[f-2],_=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[f]=g+c[f-7]+_+c[f-16]}var y=n&i^n&s^i&s,w=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),m=p+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&d)+u[f]+c[f];p=d,d=l,l=a,a=o+m|0,o=s,s=i,i=n,n=m+(w+y)|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+s|0,r[3]=r[3]+o|0,r[4]=r[4]+a|0,r[5]=r[5]+l|0,r[6]=r[6]+d|0,r[7]=r[7]+p|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=s._createHelper(l),t.HmacSHA256=s._createHmacHelper(l)}(Math),i.SHA256)}()},456:function(e,t,r){"use strict";function n(e){this.message=e}r.r(t),r.d(t,{InvalidTokenError:function(){return o}}),n.prototype=new Error,n.prototype.name="InvalidCharacterError";var i="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,s=0,o=0,a="";i=t.charAt(o++);~i&&(r=s%4?64*r+i:i,s++%4)?a+=String.fromCharCode(255&r>>(-2*s&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return a};function s(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(i(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return i(t)}}function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError",t.default=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(s(e.split(".")[r]))}catch(e){throw new o("Invalid token specified: "+e.message)}}},7187:function(e,t,r){"use strict";var n,i=r(7061).default,s=r(2122).default,o=r(215).default,a=r(7156).default,u=r(861).default,c=r(3496).default,l=r(6115).default,d=r(1655).default,p=r(6389).default,f=r(1588).default,h=r(3808).default,g=r(7424).default,v=r(3012).default,_=r(6690).default,y=r(9728).default,w=r(4704).default,m=["timeoutInSeconds"],k=["grant_type","redirect_uri","client_id","client_secret"],x=["grant_type","client_id","client_secret","scope"],b=["grant_type","client_id","client_secret","timeoutInSeconds"],S=["url","authority","client_id","redirect_uri","response_type","scope","state_data","response_mode","request_type","client_secret","nonce","resource","skipUserInfo","extraQueryParams","extraTokenParams","disablePKCE"],T=["redirectMethod"],E=["popupWindowFeatures","popupWindowTarget"],P=["silentRequestTimeoutInSeconds","resource"],O=["silentRequestTimeoutInSeconds"],I=["redirectMethod"],R=["popupWindowFeatures","popupWindowTarget"],C=["silentRequestTimeoutInSeconds"],U=Object.create,j=Object.defineProperty,M=Object.getOwnPropertyDescriptor,A=Object.getOwnPropertyNames,q=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty,H=function(e,t,r,n){if(t&&"object"===typeof t||"function"===typeof t){var i,s=w(A(t));try{var o=function(){var s=i.value;N.call(e,s)||s===r||j(e,s,{get:function(){return t[s]},enumerable:!(n=M(t,s))||n.enumerable})};for(s.s();!(i=s.n()).done;)o()}catch(a){s.e(a)}finally{s.f()}}return e},W=function(e,t,r){return r=null!=e?U(q(e)):{},H(!t&&e&&e.__esModule?r:j(r,"default",{value:e,enumerable:!0}),e)},L={};!function(e,t){for(var r in t)j(e,r,{get:t[r],enumerable:!0})}(L,{AccessTokenEvents:function(){return oe},CheckSessionIFrame:function(){return ae},ErrorResponse:function(){return ie},ErrorTimeout:function(){return se},InMemoryWebStorage:function(){return ue},Log:function(){return V},Logger:function(){return Y},MetadataService:function(){return le},OidcClient:function(){return Te},OidcClientSettingsStore:function(){return pe},SessionMonitor:function(){return Ee},SigninResponse:function(){return we},SigninState:function(){return _e},SignoutResponse:function(){return ke},State:function(){return ve},User:function(){return Pe},UserManager:function(){return Fe},UserManagerSettingsStore:function(){return Ue},Version:function(){return Be},WebStorageStateStore:function(){return de}}),e.exports=(n=L,H(j({},"__esModule",{value:!0}),n));var F,B,D,J=W(r(8926)),z=W(r(9517)),K=W(r(3713)),Q=W(r(886)),G={debug:function(){},info:function(){},warn:function(){},error:function(){}},V=function(e){return e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e}(V||{});(D=V||(V={})).reset=function(){F=3,B=G},D.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");F=e},D.setLogger=function(e){B=e};var Y=function(){function e(t){_(this,e),this._name=t}return y(e,[{key:"debug",value:function(){if(F>=4){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=B).debug.apply(t,[e._format(this._name,this._method)].concat(n))}}},{key:"info",value:function(){if(F>=3){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=B).info.apply(t,[e._format(this._name,this._method)].concat(n))}}},{key:"warn",value:function(){if(F>=2){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=B).warn.apply(t,[e._format(this._name,this._method)].concat(n))}}},{key:"error",value:function(){if(F>=1){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=B).error.apply(t,[e._format(this._name,this._method)].concat(n))}}},{key:"throw",value:function(e){throw this.error(e),e}},{key:"create",value:function(e){var t=Object.create(this);return t._method=e,t.debug("begin"),t}}],[{key:"createStatic",value:function(t,r){var n=new e("".concat(t,".").concat(r));return n.debug("begin"),n}},{key:"_format",value:function(e,t){var r="[".concat(e,"]");return t?"".concat(r," ").concat(t,":"):r}},{key:"debug",value:function(t){if(F>=4){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];(r=B).debug.apply(r,[e._format(t)].concat(i))}}},{key:"info",value:function(t){if(F>=3){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];(r=B).info.apply(r,[e._format(t)].concat(i))}}},{key:"warn",value:function(t){if(F>=2){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];(r=B).warn.apply(r,[e._format(t)].concat(i))}}},{key:"error",value:function(t){if(F>=1){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];(r=B).error.apply(r,[e._format(t)].concat(i))}}}]),e}();V.reset();var $=function(){function e(){_(this,e)}return y(e,null,[{key:"_randomWord",value:function(){return J.default.lib.WordArray.random(1).words[0]}},{key:"generateUUIDv4",value:function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(+t^e._randomWord()&15>>+t/4).toString(16)})).replace(/-/g,"")}},{key:"generateCodeVerifier",value:function(){return e.generateUUIDv4()+e.generateUUIDv4()+e.generateUUIDv4()}},{key:"generateCodeChallenge",value:function(e){try{var t=(0,z.default)(e);return K.default.stringify(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(r){throw Y.error("CryptoUtils.generateCodeChallenge",r),r}}},{key:"generateBasicAuth",value:function(e,t){var r=Q.default.parse([e,t].join(":"));return K.default.stringify(r)}}]),e}(),X=function(){function e(t){_(this,e),this._name=t,this._logger=new Y("Event('".concat(this._name,"')")),this._callbacks=[]}return y(e,[{key:"addHandler",value:function(e){var t=this;return this._callbacks.push(e),function(){return t.removeHandler(e)}}},{key:"removeHandler",value:function(e){var t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}},{key:"raise",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=this._logger).debug.apply(e,["raise:"].concat(r));var i,s=w(this._callbacks);try{for(s.s();!(i=s.n()).done;){i.value.apply(void 0,r)}}catch(o){s.e(o)}finally{s.f()}}}]),e}(),Z=W(r(456)),ee=function(){function e(){_(this,e)}return y(e,null,[{key:"decode",value:function(e){try{return(0,Z.default)(e)}catch(t){throw Y.error("JwtUtils.decode",t),t}}}]),e}(),te=function(){function e(){_(this,e)}return y(e,null,[{key:"center",value:function(e){var t,r=Object.assign({},(v(e),e));return null==r.width&&(r.width=null!=(t=[800,720,600,480].find((function(e){return e<=window.outerWidth/1.618})))?t:360),null!=r.left||(r.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-r.width)/2))),null!=r.height&&(null!=r.top||(r.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-r.height)/2)))),r}},{key:"serialize",value:function(e){return Object.entries(e).filter((function(e){return null!=g(e,2)[1]})).map((function(e){var t=g(e,2),r=t[0],n=t[1];return"".concat(r,"=").concat("boolean"!==typeof n?n:n?"yes":"no")})).join(",")}}]),e}(),re=function(e){d(r,e);var t=p(r);function r(){var e,n;return _(this,r),(n=t.apply(this,arguments))._logger=new Y("Timer('".concat(n._name,"')")),n._timerHandle=null,n._expiration=0,n._callback=function(){var t=n._expiration-r.getEpochTime();n._logger.debug("timer completes in",t),n._expiration<=r.getEpochTime()&&(n.cancel(),f((e=l(n),h(r.prototype)),"raise",e).call(e))},n}return y(r,[{key:"init",value:function(e){var t=this._logger.create("init");e=Math.max(Math.floor(e),1);var n=r.getEpochTime()+e;if(this.expiration===n&&this._timerHandle)t.debug("skipping since already initialized for expiration at",this.expiration);else{this.cancel(),t.debug("using duration",e),this._expiration=n;var i=Math.min(e,5);this._timerHandle=setInterval(this._callback,1e3*i)}}},{key:"expiration",get:function(){return this._expiration}},{key:"cancel",value:function(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}}],[{key:"getEpochTime",value:function(){return Math.floor(Date.now()/1e3)}}]),r}(X),ne=function(){function e(){_(this,e)}return y(e,null,[{key:"readParams",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"query";if(!e)throw new TypeError("Invalid URL");var r=new URL(e,"http://127.0.0.1")["fragment"===t?"hash":"search"];return new URLSearchParams(r.slice(1))}}]),e}(),ie=function(e){d(r,e);var t=p(r);function r(e,n){var i,s,o,a;if(_(this,r),(i=t.call(this,e.error_description||e.error||"")).form=n,i.name="ErrorResponse",!e.error)throw Y.error("ErrorResponse","No error passed"),new Error("No error passed");return i.error=e.error,i.error_description=null!=(s=e.error_description)?s:null,i.error_uri=null!=(o=e.error_uri)?o:null,i.state=e.userState,i.session_state=null!=(a=e.session_state)?a:null,i}return y(r)}(c(Error)),se=function(e){d(r,e);var t=p(r);function r(e){var n;return _(this,r),(n=t.call(this,e)).name="ErrorTimeout",n}return y(r)}(c(Error)),oe=function(){function e(t){_(this,e),this._logger=new Y("AccessTokenEvents"),this._expiringTimer=new re("Access token expiring"),this._expiredTimer=new re("Access token expired"),this._expiringNotificationTimeInSeconds=t.expiringNotificationTimeInSeconds}return y(e,[{key:"load",value:function(e){var t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){var r=e.expires_in;if(t.debug("access token present, remaining duration:",r),r>0){var n=r-this._expiringNotificationTimeInSeconds;n<=0&&(n=1),t.debug("registering expiring timer, raising in",n,"seconds"),this._expiringTimer.init(n)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();var i=r+1;t.debug("registering expired timer, raising in",i,"seconds"),this._expiredTimer.init(i)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}},{key:"unload",value:function(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}},{key:"addAccessTokenExpiring",value:function(e){return this._expiringTimer.addHandler(e)}},{key:"removeAccessTokenExpiring",value:function(e){this._expiringTimer.removeHandler(e)}},{key:"addAccessTokenExpired",value:function(e){return this._expiredTimer.addHandler(e)}},{key:"removeAccessTokenExpired",value:function(e){this._expiredTimer.removeHandler(e)}}]),e}(),ae=function(){function e(t,r,n,i,s){var o=this;_(this,e),this._callback=t,this._client_id=r,this._intervalInSeconds=i,this._stopOnError=s,this._logger=new Y("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=function(e){e.origin===o._frame_origin&&e.source===o._frame.contentWindow&&("error"===e.data?(o._logger.error("error message from check session op iframe"),o._stopOnError&&o.stop()):"changed"===e.data?(o._logger.debug("changed message from check session op iframe"),o.stop(),o._callback()):o._logger.debug(e.data+" message from check session op iframe"))};var a=new URL(n);this._frame_origin=a.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=a.href}return y(e,[{key:"load",value:function(){var e=this;return new Promise((function(t){e._frame.onload=function(){t()},window.document.body.appendChild(e._frame),window.addEventListener("message",e._message,!1)}))}},{key:"start",value:function(e){var t=this;if(this._session_state!==e){this._logger.create("start"),this.stop(),this._session_state=e;var r=function(){t._frame.contentWindow&&t._session_state&&t._frame.contentWindow.postMessage(t._client_id+" "+t._session_state,t._frame_origin)};r(),this._timer=setInterval(r,1e3*this._intervalInSeconds)}}},{key:"stop",value:function(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}}]),e}(),ue=function(){function e(){_(this,e),this._logger=new Y("InMemoryWebStorage"),this._data={}}return y(e,[{key:"clear",value:function(){this._logger.create("clear"),this._data={}}},{key:"getItem",value:function(e){return this._logger.create("getItem('".concat(e,"')")),this._data[e]}},{key:"setItem",value:function(e,t){this._logger.create("setItem('".concat(e,"')")),this._data[e]=t}},{key:"removeItem",value:function(e){this._logger.create("removeItem('".concat(e,"')")),delete this._data[e]}},{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}},{key:"key",value:function(e){return Object.getOwnPropertyNames(this._data)[e]}}]),e}(),ce=function(){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_(this,e),this._jwtHandler=n,this._extraHeaders=i,this._logger=new Y("JsonService"),this._contentTypes=[],(t=this._contentTypes).push.apply(t,u(r).concat(["application/json"])),n&&this._contentTypes.push("application/jwt")}return y(e,[{key:"fetchWithTimeout",value:function(){var e=a(i().mark((function e(t){var r,n,a,u,c,l,d=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(r=d.length>1&&void 0!==d[1]?d[1]:{}).timeoutInSeconds,a=o(r,m),n){e.next=6;break}return e.next=5,fetch(t,a);case 5:return e.abrupt("return",e.sent);case 6:return u=new AbortController,c=setTimeout((function(){return u.abort()}),1e3*n),e.prev=8,e.next=11,fetch(t,s(s({},r),{},{signal:u.signal}));case 11:return l=e.sent,e.abrupt("return",l);case 15:if(e.prev=15,e.t0=e.catch(8),!(e.t0 instanceof DOMException&&"AbortError"===e.t0.name)){e.next=19;break}throw new se("Network timed out");case 19:throw e.t0;case 20:return e.prev=20,clearTimeout(c),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[8,15,20,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getJson",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,a,u,c,l,d=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(r=d.length>1&&void 0!==d[1]?d[1]:{}).token,s=r.credentials,o=this._logger.create("getJson"),a={Accept:this._contentTypes.join(", ")},n&&(o.debug("token passed, setting Authorization header"),a.Authorization="Bearer "+n),this.appendExtraHeaders(a),e.prev=5,o.debug("url:",t),e.next=9,this.fetchWithTimeout(t,{method:"GET",headers:a,credentials:s});case 9:u=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(5),o.error("Network Error"),e.t0;case 16:if(o.debug("HTTP response received, status",u.status),(c=u.headers.get("Content-Type"))&&!this._contentTypes.find((function(e){return c.startsWith(e)}))&&o.throw(new Error("Invalid response Content-Type: ".concat(null!=c?c:"undefined",", from URL: ").concat(t))),!(u.ok&&this._jwtHandler&&(null==c?void 0:c.startsWith("application/jwt")))){e.next=27;break}return e.t1=this,e.next=23,u.text();case 23:return e.t2=e.sent,e.next=26,e.t1._jwtHandler.call(e.t1,e.t2);case 26:return e.abrupt("return",e.sent);case 27:return e.prev=27,e.next=30,u.json();case 30:l=e.sent,e.next=39;break;case 33:if(e.prev=33,e.t3=e.catch(27),o.error("Error parsing JSON response",e.t3),!u.ok){e.next=38;break}throw e.t3;case 38:throw new Error("".concat(u.statusText," (").concat(u.status,")"));case 39:if(u.ok){e.next=44;break}if(o.error("Error from server:",l),!l.error){e.next=43;break}throw new ie(l);case 43:throw new Error("".concat(u.statusText," (").concat(u.status,"): ").concat(JSON.stringify(l)));case 44:return e.abrupt("return",l);case 45:case"end":return e.stop()}}),e,this,[[5,12],[27,33]])})));return function(t){return e.apply(this,arguments)}}()},{key:"postForm",value:function(){var e=a(i().mark((function e(t,r){var n,s,o,a,u,c,l,d,p,f;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.body,s=r.basicAuth,o=r.timeoutInSeconds,a=r.initCredentials,u=this._logger.create("postForm"),c={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"},void 0!==s&&(c.Authorization="Basic "+s),this.appendExtraHeaders(c),e.prev=5,u.debug("url:",t),e.next=9,this.fetchWithTimeout(t,{method:"POST",headers:c,body:n,timeoutInSeconds:o,credentials:a});case 9:l=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(5),u.error("Network error"),e.t0;case 16:if(u.debug("HTTP response received, status",l.status),!(d=l.headers.get("Content-Type"))||this._contentTypes.find((function(e){return d.startsWith(e)}))){e.next=20;break}throw new Error("Invalid response Content-Type: ".concat(null!=d?d:"undefined",", from URL: ").concat(t));case 20:return e.next=22,l.text();case 22:if(p=e.sent,f={},!p){e.next=35;break}e.prev=25,f=JSON.parse(p),e.next=35;break;case 29:if(e.prev=29,e.t1=e.catch(25),u.error("Error parsing JSON response",e.t1),!l.ok){e.next=34;break}throw e.t1;case 34:throw new Error("".concat(l.statusText," (").concat(l.status,")"));case 35:if(l.ok){e.next=40;break}if(u.error("Error from server:",f),!f.error){e.next=39;break}throw new ie(f,n);case 39:throw new Error("".concat(l.statusText," (").concat(l.status,"): ").concat(JSON.stringify(f)));case 40:return e.abrupt("return",f);case 41:case"end":return e.stop()}}),e,this,[[5,12],[25,29]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"appendExtraHeaders",value:function(e){var t=this,r=this._logger.create("appendExtraHeaders"),n=Object.keys(this._extraHeaders),i=["authorization","accept","content-type"];0!==n.length&&n.forEach((function(n){if(i.includes(n.toLocaleLowerCase()))r.warn("Protected header could not be overridden",n,i);else{var s="function"===typeof t._extraHeaders[n]?t._extraHeaders[n]():t._extraHeaders[n];s&&""!==s&&(e[n]=s)}}))}}]),e}(),le=function(){function e(t){_(this,e),this._settings=t,this._logger=new Y("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new ce(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}return y(e,[{key:"resetSigningKeys",value:function(){this._signingKeys=null}},{key:"getMetadata",value:function(){var e=a(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._logger.create("getMetadata"),!this._metadata){e.next=4;break}return t.debug("using cached values"),e.abrupt("return",this._metadata);case 4:if(this._metadataUrl){e.next=7;break}throw t.throw(new Error("No authority or metadataUrl configured on settings")),null;case 7:return t.debug("getting metadata from",this._metadataUrl),e.next=10,this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});case 10:return r=e.sent,t.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,r),e.abrupt("return",this._metadata);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getIssuer",value:function(){return this._getMetadataProperty("issuer")}},{key:"getAuthorizationEndpoint",value:function(){return this._getMetadataProperty("authorization_endpoint")}},{key:"getUserInfoEndpoint",value:function(){return this._getMetadataProperty("userinfo_endpoint")}},{key:"getTokenEndpoint",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)}},{key:"getCheckSessionIframe",value:function(){return this._getMetadataProperty("check_session_iframe",!0)}},{key:"getEndSessionEndpoint",value:function(){return this._getMetadataProperty("end_session_endpoint",!0)}},{key:"getRevocationEndpoint",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("revocation_endpoint",e)}},{key:"getKeysEndpoint",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("jwks_uri",e)}},{key:"_getMetadataProperty",value:function(){var e=a(i().mark((function e(t){var r,n,s,o=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],n=this._logger.create("_getMetadataProperty('".concat(t,"')")),e.next=4,this.getMetadata();case 4:if(s=e.sent,n.debug("resolved"),void 0!==s[t]){e.next=11;break}if(!0!==r){e.next=10;break}return n.warn("Metadata does not contain optional property"),e.abrupt("return",void 0);case 10:n.throw(new Error("Metadata does not contain property "+t));case 11:return e.abrupt("return",s[t]);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSigningKeys",value:function(){var e=a(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._logger.create("getSigningKeys"),!this._signingKeys){e.next=4;break}return t.debug("returning signingKeys from cache"),e.abrupt("return",this._signingKeys);case 4:return e.next=6,this.getKeysEndpoint(!1);case 6:return r=e.sent,t.debug("got jwks_uri",r),e.next=10,this._jsonService.getJson(r);case 10:if(n=e.sent,t.debug("got key set",n),Array.isArray(n.keys)){e.next=15;break}throw t.throw(new Error("Missing keys on keyset")),null;case 15:return this._signingKeys=n.keys,e.abrupt("return",this._signingKeys);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),de=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.prefix,n=void 0===r?"oidc.":r,i=t.store,s=void 0===i?localStorage:i;_(this,e),this._logger=new Y("WebStorageStateStore"),this._store=s,this._prefix=n}return y(e,[{key:"set",value:function(){var e=a(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("set('".concat(t,"')")),t=this._prefix+t,e.next=4,this._store.setItem(t,r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=a(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("get('".concat(t,"')")),t=this._prefix+t,e.next=4,this._store.getItem(t);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=a(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("remove('".concat(t,"')")),t=this._prefix+t,e.next=4,this._store.getItem(t);case 4:return r=e.sent,e.next=7,this._store.removeItem(t);case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllKeys",value:function(){var e=a(i().mark((function e(){var t,r,n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("getAllKeys"),e.next=3,this._store.length;case 3:t=e.sent,r=[],n=0;case 6:if(!(n<t)){e.next=14;break}return e.next=9,this._store.key(n);case 9:(s=e.sent)&&0===s.indexOf(this._prefix)&&r.push(s.substr(this._prefix.length));case 11:n++,e.next=6;break;case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),pe=y((function e(t){var r=t.authority,n=t.metadataUrl,i=t.metadata,s=t.signingKeys,o=t.metadataSeed,a=t.client_id,u=t.client_secret,c=t.response_type,l=void 0===c?"code":c,d=t.scope,p=void 0===d?"openid":d,f=t.redirect_uri,h=t.post_logout_redirect_uri,g=t.client_authentication,v=void 0===g?"client_secret_post":g,y=t.prompt,w=t.display,m=t.max_age,k=t.ui_locales,x=t.acr_values,b=t.resource,S=t.response_mode,T=void 0===S?"query":S,E=t.filterProtocolClaims,P=void 0===E||E,O=t.loadUserInfo,I=void 0!==O&&O,R=t.staleStateAgeInSeconds,C=void 0===R?900:R,U=t.clockSkewInSeconds,j=void 0===U?300:U,M=t.userInfoJwtIssuer,A=void 0===M?"OP":M,q=t.mergeClaims,N=void 0!==q&&q,H=t.disablePKCE,W=void 0!==H&&H,L=t.stateStore,F=t.refreshTokenCredentials,B=t.revokeTokenAdditionalContentTypes,D=t.fetchRequestCredentials,J=t.refreshTokenAllowedScope,z=t.extraQueryParams,K=void 0===z?{}:z,Q=t.extraTokenParams,G=void 0===Q?{}:Q,V=t.extraHeaders,Y=void 0===V?{}:V;if(_(this,e),this.authority=r,n?this.metadataUrl=n:(this.metadataUrl=r,r&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=i,this.metadataSeed=o,this.signingKeys=s,this.client_id=a,this.client_secret=u,this.response_type=l,this.scope=p,this.redirect_uri=f,this.post_logout_redirect_uri=h,this.client_authentication=v,this.prompt=y,this.display=w,this.max_age=m,this.ui_locales=k,this.acr_values=x,this.resource=b,this.response_mode=T,this.filterProtocolClaims=null==P||P,this.loadUserInfo=!!I,this.staleStateAgeInSeconds=C,this.clockSkewInSeconds=j,this.userInfoJwtIssuer=A,this.mergeClaims=!!N,this.disablePKCE=!!W,this.revokeTokenAdditionalContentTypes=B,D&&F&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=D||(F||"same-origin"),L)this.stateStore=L;else{var $="undefined"!==typeof window?window.localStorage:new ue;this.stateStore=new de({store:$})}this.refreshTokenAllowedScope=J,this.extraQueryParams=K,this.extraTokenParams=G,this.extraHeaders=Y})),fe=function(){function e(t,r){var n=this;_(this,e),this._settings=t,this._metadataService=r,this._logger=new Y("UserInfoService"),this._getClaimsFromJwt=function(){var e=a(i().mark((function e(t){var r,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n._logger.create("_getClaimsFromJwt"),e.prev=1,s=ee.decode(t),r.debug("JWT decoding successful"),e.abrupt("return",s);case 7:throw e.prev=7,e.t0=e.catch(1),r.error("Error parsing JWT response"),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this._jsonService=new ce(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}return y(e,[{key:"getClaims",value:function(){var e=a(i().mark((function e(t){var r,n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("getClaims"),t||this._logger.throw(new Error("No token passed")),e.next=4,this._metadataService.getUserInfoEndpoint();case 4:return n=e.sent,r.debug("got userinfo url",n),e.next=8,this._jsonService.getJson(n,{token:t,credentials:this._settings.fetchRequestCredentials});case 8:return s=e.sent,r.debug("got claims",s),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),he=function(){function e(t,r){_(this,e),this._settings=t,this._metadataService=r,this._logger=new Y("TokenClient"),this._jsonService=new ce(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}return y(e,[{key:"exchangeCode",value:function(){var e=a(i().mark((function e(t){var r,n,s,a,u,c,l,d,p,f,h,v,_,y,w,m,x,b,S;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=t.grant_type,n=void 0===r?"authorization_code":r,s=t.redirect_uri,a=void 0===s?this._settings.redirect_uri:s,u=t.client_id,c=void 0===u?this._settings.client_id:u,l=t.client_secret,d=void 0===l?this._settings.client_secret:l,p=o(t,k),f=this._logger.create("exchangeCode"),c||f.throw(new Error("A client_id is required")),a||f.throw(new Error("A redirect_uri is required")),p.code||f.throw(new Error("A code is required")),h=new URLSearchParams({grant_type:n,redirect_uri:a}),v=0,_=Object.entries(p);v<_.length;v++)y=g(_[v],2),w=y[0],null!=(m=y[1])&&h.set(w,m);e.t0=this._settings.client_authentication,e.next="client_secret_basic"===e.t0?10:"client_secret_post"===e.t0?15:18;break;case 10:if(d){e.next=13;break}throw f.throw(new Error("A client_secret is required")),null;case 13:return x=$.generateBasicAuth(c,d),e.abrupt("break",18);case 15:return h.append("client_id",c),d&&h.append("client_secret",d),e.abrupt("break",18);case 18:return e.next=20,this._metadataService.getTokenEndpoint(!1);case 20:return b=e.sent,f.debug("got token endpoint"),e.next=24,this._jsonService.postForm(b,{body:h,basicAuth:x,initCredentials:this._settings.fetchRequestCredentials});case 24:return S=e.sent,f.debug("got response"),e.abrupt("return",S);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"exchangeCredentials",value:function(){var e=a(i().mark((function e(t){var r,n,s,a,u,c,l,d,p,f,h,v,_,y,w,m,k,b,S;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=t.grant_type,n=void 0===r?"password":r,s=t.client_id,a=void 0===s?this._settings.client_id:s,u=t.client_secret,c=void 0===u?this._settings.client_secret:u,l=t.scope,d=void 0===l?this._settings.scope:l,p=o(t,x),f=this._logger.create("exchangeCredentials"),a||f.throw(new Error("A client_id is required")),h=new URLSearchParams({grant_type:n,scope:d}),v=0,_=Object.entries(p);v<_.length;v++)y=g(_[v],2),w=y[0],null!=(m=y[1])&&h.set(w,m);e.t0=this._settings.client_authentication,e.next="client_secret_basic"===e.t0?8:"client_secret_post"===e.t0?13:16;break;case 8:if(c){e.next=11;break}throw f.throw(new Error("A client_secret is required")),null;case 11:return k=$.generateBasicAuth(a,c),e.abrupt("break",16);case 13:return h.append("client_id",a),c&&h.append("client_secret",c),e.abrupt("break",16);case 16:return e.next=18,this._metadataService.getTokenEndpoint(!1);case 18:return b=e.sent,f.debug("got token endpoint"),e.next=22,this._jsonService.postForm(b,{body:h,basicAuth:k,initCredentials:this._settings.fetchRequestCredentials});case 22:return S=e.sent,f.debug("got response"),e.abrupt("return",S);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"exchangeRefreshToken",value:function(){var e=a(i().mark((function e(t){var r,n,s,a,u,c,l,d,p,f,h,v,_,y,w,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.grant_type,n=void 0===r?"refresh_token":r,s=t.client_id,a=void 0===s?this._settings.client_id:s,u=t.client_secret,c=void 0===u?this._settings.client_secret:u,l=t.timeoutInSeconds,d=o(t,b),p=this._logger.create("exchangeRefreshToken"),a||p.throw(new Error("A client_id is required")),d.refresh_token||p.throw(new Error("A refresh_token is required")),f=new URLSearchParams({grant_type:n}),h=i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g(_[v],2),r=t[0],n=t[1],Array.isArray(n)?n.forEach((function(e){return f.append(r,e)})):null!=n&&f.set(r,n);case 2:case"end":return e.stop()}}),e)})),v=0,_=Object.entries(d);case 7:if(!(v<_.length)){e.next=12;break}return e.delegateYield(h(),"t0",9);case 9:v++,e.next=7;break;case 12:e.t1=this._settings.client_authentication,e.next="client_secret_basic"===e.t1?15:"client_secret_post"===e.t1?20:23;break;case 15:if(c){e.next=18;break}throw p.throw(new Error("A client_secret is required")),null;case 18:return y=$.generateBasicAuth(a,c),e.abrupt("break",23);case 20:return f.append("client_id",a),c&&f.append("client_secret",c),e.abrupt("break",23);case 23:return e.next=25,this._metadataService.getTokenEndpoint(!1);case 25:return w=e.sent,p.debug("got token endpoint"),e.next=29,this._jsonService.postForm(w,{body:f,basicAuth:y,timeoutInSeconds:l,initCredentials:this._settings.fetchRequestCredentials});case 29:return m=e.sent,p.debug("got response"),e.abrupt("return",m);case 32:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"revoke",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,a,u,c,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("revoke"),t.token||n.throw(new Error("A token is required")),e.next=4,this._metadataService.getRevocationEndpoint(!1);case 4:for(s=e.sent,n.debug("got revocation endpoint, revoking ".concat(null!=(r=t.token_type_hint)?r:"default token type")),o=new URLSearchParams,a=0,u=Object.entries(t);a<u.length;a++)c=g(u[a],2),l=c[0],null!=(d=c[1])&&o.set(l,d);return o.set("client_id",this._settings.client_id),this._settings.client_secret&&o.set("client_secret",this._settings.client_secret),e.next=12,this._jsonService.postForm(s,{body:o});case 12:n.debug("got response");case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ge=function(){function e(t,r,n){_(this,e),this._settings=t,this._metadataService=r,this._claimsService=n,this._logger=new Y("ResponseValidator"),this._userInfoService=new fe(this._settings,this._metadataService),this._tokenClient=new he(this._settings,this._metadataService)}return y(e,[{key:"validateSigninResponse",value:function(){var e=a(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("validateSigninResponse"),this._processSigninState(t,r),n.debug("state processed"),e.next=5,this._processCode(t,r);case 5:return n.debug("code processed"),t.isOpenId&&this._validateIdTokenAttributes(t),n.debug("tokens validated"),e.next=10,this._processClaims(t,null==r?void 0:r.skipUserInfo,t.isOpenId);case 10:n.debug("claims processed");case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"validateCredentialsResponse",value:function(){var e=a(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("validateCredentialsResponse"),t.isOpenId&&this._validateIdTokenAttributes(t),n.debug("tokens validated"),e.next=5,this._processClaims(t,r,t.isOpenId);case 5:n.debug("claims processed");case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"validateRefreshResponse",value:function(){var e=a(i().mark((function e(t,r){var n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("validateRefreshResponse"),t.userState=r.data,null!=t.session_state||(t.session_state=r.session_state),null!=t.scope||(t.scope=r.scope),t.isOpenId&&t.id_token&&(this._validateIdTokenAttributes(t,r.id_token),n.debug("ID Token validated")),t.id_token||(t.id_token=r.id_token,t.profile=r.profile),s=t.isOpenId&&!!t.id_token,e.next=9,this._processClaims(t,!1,s);case 9:n.debug("claims processed");case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"validateSignoutResponse",value:function(e,t){var r=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&r.throw(new Error("State does not match")),r.debug("state validated"),e.userState=t.data,e.error)throw r.warn("Response was error",e.error),new ie(e)}},{key:"_processSigninState",value:function(e,t){var r=this._logger.create("_processSigninState");if(t.id!==e.state&&r.throw(new Error("State does not match")),t.client_id||r.throw(new Error("No client_id on state")),t.authority||r.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&r.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&r.throw(new Error("client_id mismatch on settings vs. signin state")),r.debug("state validated"),e.userState=t.data,null!=e.scope||(e.scope=t.scope),e.error)throw r.warn("Response was error",e.error),new ie(e);t.code_verifier&&!e.code&&r.throw(new Error("Expected code in response"))}},{key:"_processClaims",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,a=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>1&&void 0!==a[1]&&a[1],n=!(a.length>2&&void 0!==a[2])||a[2],s=this._logger.create("_processClaims"),t.profile=this._claimsService.filterProtocolClaims(t.profile),!r&&this._settings.loadUserInfo&&t.access_token){e.next=7;break}return s.debug("not loading user info"),e.abrupt("return");case 7:return s.debug("loading user info"),e.next=10,this._userInfoService.getClaims(t.access_token);case 10:o=e.sent,s.debug("user info claims received from user info endpoint"),n&&o.sub!==t.profile.sub&&s.throw(new Error("subject from UserInfo response does not match subject in ID Token")),t.profile=this._claimsService.mergeClaims(t.profile,this._claimsService.filterProtocolClaims(o)),s.debug("user info claims received, updated profile:",t.profile);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_processCode",value:function(){var e=a(i().mark((function e(t,r){var n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._logger.create("_processCode"),!t.code){e.next=9;break}return n.debug("Validating code"),e.next=5,this._tokenClient.exchangeCode(s({client_id:r.client_id,client_secret:r.client_secret,code:t.code,redirect_uri:r.redirect_uri,code_verifier:r.code_verifier},r.extraTokenParams));case 5:o=e.sent,Object.assign(t,o),e.next=10;break;case 9:n.debug("No code to process");case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_validateIdTokenAttributes",value:function(e,t){var r,n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");var i=ee.decode(null!=(r=e.id_token)?r:"");if(i.sub||n.throw(new Error("ID Token is missing a subject claim")),t){var s=ee.decode(t);i.sub!==s.sub&&n.throw(new Error("sub in id_token does not match current sub")),i.auth_time&&i.auth_time!==s.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),i.azp&&i.azp!==s.azp&&n.throw(new Error("azp in id_token does not match original azp")),!i.azp&&s.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=i}}]),e}(),ve=function(){function e(t){_(this,e),this.id=t.id||$.generateUUIDv4(),this.data=t.data,t.created&&t.created>0?this.created=t.created:this.created=re.getEpochTime(),this.request_type=t.request_type}return y(e,[{key:"toStorageString",value:function(){return new Y("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})}}],[{key:"fromStorageString",value:function(t){return Y.createStatic("State","fromStorageString"),new e(JSON.parse(t))}},{key:"clearStaleState",value:function(){var t=a(i().mark((function t(r,n){var s,o,a,u,c,l,d,p;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=Y.createStatic("State","clearStaleState"),o=re.getEpochTime()-n,t.next=4,r.getAllKeys();case 4:a=t.sent,s.debug("got keys",a),u=0;case 7:if(!(u<a.length)){t.next=18;break}return c=a[u],t.next=11,r.get(c);case 11:if(l=t.sent,d=!1,l)try{p=e.fromStorageString(l),s.debug("got item from key:",c,p.created),p.created<=o&&(d=!0)}catch(i){s.error("Error parsing state for key:",c,i),d=!0}else s.debug("no item in storage for key:",c),d=!0;d&&(s.debug("removed item for key:",c),r.remove(c));case 15:u++,t.next=7;break;case 18:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()}]),e}(),_e=function(e){d(r,e);var t=p(r);function r(e){var n;return _(this,r),n=t.call(this,e),!0===e.code_verifier?n.code_verifier=$.generateCodeVerifier():e.code_verifier&&(n.code_verifier=e.code_verifier),n.code_verifier&&(n.code_challenge=$.generateCodeChallenge(n.code_verifier)),n.authority=e.authority,n.client_id=e.client_id,n.redirect_uri=e.redirect_uri,n.scope=e.scope,n.client_secret=e.client_secret,n.extraTokenParams=e.extraTokenParams,n.response_mode=e.response_mode,n.skipUserInfo=e.skipUserInfo,n}return y(r,[{key:"toStorageString",value:function(){return new Y("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}}],[{key:"fromStorageString",value:function(e){return Y.createStatic("SigninState","fromStorageString"),new r(JSON.parse(e))}}]),r}(ve),ye=y((function e(t){var r=t.url,n=t.authority,i=t.client_id,a=t.redirect_uri,u=t.response_type,c=t.scope,l=t.state_data,d=t.response_mode,p=t.request_type,f=t.client_secret,h=t.nonce,v=t.resource,y=t.skipUserInfo,w=t.extraQueryParams,m=t.extraTokenParams,k=t.disablePKCE,x=o(t,S);if(_(this,e),this._logger=new Y("SigninRequest"),!r)throw this._logger.error("ctor: No url passed"),new Error("url");if(!i)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!a)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!u)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!c)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!n)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new _e({data:l,request_type:p,code_verifier:!k,client_id:i,authority:n,redirect_uri:a,response_mode:d,client_secret:f,scope:c,extraTokenParams:m,skipUserInfo:y});var b=new URL(r);(b.searchParams.append("client_id",i),b.searchParams.append("redirect_uri",a),b.searchParams.append("response_type",u),b.searchParams.append("scope",c),h&&b.searchParams.append("nonce",h),b.searchParams.append("state",this.state.id),this.state.code_challenge&&(b.searchParams.append("code_challenge",this.state.code_challenge),b.searchParams.append("code_challenge_method","S256")),v)&&(Array.isArray(v)?v:[v]).forEach((function(e){return b.searchParams.append("resource",e)}));for(var T=0,E=Object.entries(s(s({response_mode:d},x),w));T<E.length;T++){var P=g(E[T],2),O=P[0],I=P[1];null!=I&&b.searchParams.append(O,I.toString())}this.url=b.href})),we=function(){function e(t){_(this,e),this.access_token="",this.token_type="",this.profile={},this.state=t.get("state"),this.session_state=t.get("session_state"),this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri"),this.code=t.get("code")}return y(e,[{key:"expires_in",get:function(){if(void 0!==this.expires_at)return this.expires_at-re.getEpochTime()},set:function(e){"string"===typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+re.getEpochTime())}},{key:"isOpenId",get:function(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}}]),e}(),me=y((function e(t){var r=t.url,n=t.state_data,i=t.id_token_hint,o=t.post_logout_redirect_uri,a=t.extraQueryParams,u=t.request_type,c=t.client_id;if(_(this,e),this._logger=new Y("SignoutRequest"),!r)throw this._logger.error("ctor: No url passed"),new Error("url");var l=new URL(r);i&&l.searchParams.append("id_token_hint",i),c&&l.searchParams.append("client_id",c),o&&(l.searchParams.append("post_logout_redirect_uri",o),n&&(this.state=new ve({data:n,request_type:u}),l.searchParams.append("state",this.state.id)));for(var d=0,p=Object.entries(s({},a));d<p.length;d++){var f=g(p[d],2),h=f[0],v=f[1];null!=v&&l.searchParams.append(h,v.toString())}this.url=l.href})),ke=y((function e(t){_(this,e),this.state=t.get("state"),this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri")})),xe=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],be=["sub","iss","aud","exp","iat"],Se=function(){function e(t){_(this,e),this._settings=t,this._logger=new Y("ClaimsService")}return y(e,[{key:"filterProtocolClaims",value:function(e){var t=s({},e);if(this._settings.filterProtocolClaims){var r;r=Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:xe;var n,i=w(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;be.includes(o)||delete t[o]}}catch(a){i.e(a)}finally{i.f()}}return t}},{key:"mergeClaims",value:function(e,t){for(var r=s({},e),n=0,i=Object.entries(t);n<i.length;n++){var o,a=g(i[n],2),u=a[0],c=a[1],l=w(Array.isArray(c)?c:[c]);try{for(l.s();!(o=l.n()).done;){var d=o.value,p=r[u];p?Array.isArray(p)?p.includes(d)||p.push(d):r[u]!==d&&("object"===typeof d&&this._settings.mergeClaims?r[u]=this.mergeClaims(p,d):r[u]=[p,d]):r[u]=d}}catch(f){l.e(f)}finally{l.f()}}return r}}]),e}(),Te=function(){function e(t,r){_(this,e),this._logger=new Y("OidcClient"),this.settings=t instanceof pe?t:new pe(t),this.metadataService=null!=r?r:new le(this.settings),this._claimsService=new Se(this.settings),this._validator=new ge(this.settings,this.metadataService,this._claimsService),this._tokenClient=new he(this.settings,this.metadataService)}return y(e,[{key:"createSigninRequest",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,a,u,c,l,d,p,f,h,g,v,_,y,w,m,k,x,b,S,T,E,P,O,I,R,C,U,j,M,A,q,N,H;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state,n=t.request,s=t.request_uri,o=t.request_type,a=t.id_token_hint,u=t.login_hint,c=t.skipUserInfo,l=t.nonce,d=t.response_type,p=void 0===d?this.settings.response_type:d,f=t.scope,h=void 0===f?this.settings.scope:f,g=t.redirect_uri,v=void 0===g?this.settings.redirect_uri:g,_=t.prompt,y=void 0===_?this.settings.prompt:_,w=t.display,m=void 0===w?this.settings.display:w,k=t.max_age,x=void 0===k?this.settings.max_age:k,b=t.ui_locales,S=void 0===b?this.settings.ui_locales:b,T=t.acr_values,E=void 0===T?this.settings.acr_values:T,P=t.resource,O=void 0===P?this.settings.resource:P,I=t.response_mode,R=void 0===I?this.settings.response_mode:I,C=t.extraQueryParams,U=void 0===C?this.settings.extraQueryParams:C,j=t.extraTokenParams,M=void 0===j?this.settings.extraTokenParams:j,A=this._logger.create("createSigninRequest"),"code"===p){e.next=4;break}throw new Error("Only the Authorization Code flow (with PKCE) is supported");case 4:return e.next=6,this.metadataService.getAuthorizationEndpoint();case 6:return q=e.sent,A.debug("Received authorization endpoint",q),N=new ye({url:q,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:v,response_type:p,scope:h,state_data:r,prompt:y,display:m,max_age:x,ui_locales:S,id_token_hint:a,login_hint:u,acr_values:E,resource:O,request:n,request_uri:s,extraQueryParams:U,extraTokenParams:M,request_type:o,response_mode:R,client_secret:this.settings.client_secret,skipUserInfo:c,nonce:l,disablePKCE:this.settings.disablePKCE}),e.next=11,this.clearStaleState();case 11:return H=N.state,e.next=14,this.settings.stateStore.set(H.id,H.toStorageString());case 14:return e.abrupt("return",N);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSigninResponseState",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,a,u=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]&&u[1],n=this._logger.create("readSigninResponseState"),(s=new we(ne.readParams(t,this.settings.response_mode))).state){e.next=6;break}throw n.throw(new Error("No state in response")),null;case 6:return e.next=8,this.settings.stateStore[r?"remove":"get"](s.state);case 8:if(o=e.sent){e.next=12;break}throw n.throw(new Error("No matching state found in storage")),null;case 12:return a=_e.fromStorageString(o),e.abrupt("return",{state:a,response:s});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processSigninResponse",value:function(){var e=a(i().mark((function e(t){var r,n,s,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("processSigninResponse"),e.next=3,this.readSigninResponseState(t,!0);case 3:return n=e.sent,s=n.state,o=n.response,r.debug("received state from storage; validating response"),e.next=9,this._validator.validateSigninResponse(o,s);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processResourceOwnerPasswordCredentials",value:function(){var e=a(i().mark((function e(t){var r,n,o,a,u,c,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.username,n=t.password,o=t.skipUserInfo,a=void 0!==o&&o,u=t.extraTokenParams,c=void 0===u?{}:u,e.next=3,this._tokenClient.exchangeCredentials(s({username:r,password:n},c));case 3:return l=e.sent,d=new we(new URLSearchParams),Object.assign(d,l),e.next=8,this._validator.validateCredentialsResponse(d,a);case 8:return e.abrupt("return",d);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"useRefreshToken",value:function(){var e=a(i().mark((function e(t){var r,n,o,a,u,c,l,d,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.state,n=t.timeoutInSeconds,a=this._logger.create("useRefreshToken"),void 0===this.settings.refreshTokenAllowedScope?u=r.scope:(c=this.settings.refreshTokenAllowedScope.split(" "),l=(null==(o=r.scope)?void 0:o.split(" "))||[],u=l.filter((function(e){return c.includes(e)})).join(" ")),e.next=5,this._tokenClient.exchangeRefreshToken({refresh_token:r.refresh_token,resource:r.resource,scope:u,timeoutInSeconds:n});case 5:return d=e.sent,p=new we(new URLSearchParams),Object.assign(p,d),a.debug("validating response",p),e.next=11,this._validator.validateRefreshResponse(p,s(s({},r),{},{scope:u}));case 11:return e.abrupt("return",p);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSignoutRequest",value:function(){var e=a(i().mark((function e(){var t,r,n,s,o,a,u,c,l,d,p,f,h,g=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t=g.length>0&&void 0!==g[0]?g[0]:{}).state,n=t.id_token_hint,s=t.client_id,o=t.request_type,a=t.post_logout_redirect_uri,u=void 0===a?this.settings.post_logout_redirect_uri:a,c=t.extraQueryParams,l=void 0===c?this.settings.extraQueryParams:c,d=this._logger.create("createSignoutRequest"),e.next=4,this.metadataService.getEndSessionEndpoint();case 4:if(p=e.sent){e.next=8;break}throw d.throw(new Error("No end session endpoint")),null;case 8:return d.debug("Received end session endpoint",p),s||!u||n||(s=this.settings.client_id),f=new me({url:p,id_token_hint:n,client_id:s,post_logout_redirect_uri:u,state_data:r,extraQueryParams:l,request_type:o}),e.next=13,this.clearStaleState();case 13:if(!(h=f.state)){e.next=18;break}return d.debug("Signout request has state to persist"),e.next=18,this.settings.stateStore.set(h.id,h.toStorageString());case 18:return e.abrupt("return",f);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readSignoutResponseState",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,a,u=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]&&u[1],n=this._logger.create("readSignoutResponseState"),(s=new ke(ne.readParams(t,this.settings.response_mode))).state){e.next=9;break}if(n.debug("No state in response"),!s.error){e.next=8;break}throw n.warn("Response was error:",s.error),new ie(s);case 8:return e.abrupt("return",{state:void 0,response:s});case 9:return e.next=11,this.settings.stateStore[r?"remove":"get"](s.state);case 11:if(o=e.sent){e.next=15;break}throw n.throw(new Error("No matching state found in storage")),null;case 15:return a=ve.fromStorageString(o),e.abrupt("return",{state:a,response:s});case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processSignoutResponse",value:function(){var e=a(i().mark((function e(t){var r,n,s,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("processSignoutResponse"),e.next=3,this.readSignoutResponseState(t,!0);case 3:return n=e.sent,s=n.state,o=n.response,s?(r.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(o,s)):r.debug("No state from storage; skipping response validation"),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearStaleState",value:function(){return this._logger.create("clearStaleState"),ve.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}},{key:"revokeToken",value:function(){var e=a(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("revokeToken"),e.next=3,this._tokenClient.revoke({token:t,token_type_hint:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),Ee=function(){function e(t){var r=this;_(this,e),this._userManager=t,this._logger=new Y("SessionMonitor"),this._start=function(){var e=a(i().mark((function e(t){var n,s,o,a,u,c,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.session_state){e.next=3;break}return e.abrupt("return");case 3:if(s=r._logger.create("_start"),t.profile?(r._sub=t.profile.sub,r._sid=t.profile.sid,s.debug("session_state",n,", sub",r._sub)):(r._sub=void 0,r._sid=void 0,s.debug("session_state",n,", anonymous user")),!r._checkSessionIFrame){e.next=8;break}return r._checkSessionIFrame.start(n),e.abrupt("return");case 8:return e.prev=8,e.next=11,r._userManager.metadataService.getCheckSessionIframe();case 11:if(!(o=e.sent)){e.next=24;break}return s.debug("initializing check session iframe"),a=r._userManager.settings.client_id,u=r._userManager.settings.checkSessionIntervalInSeconds,c=r._userManager.settings.stopCheckSessionOnError,l=new ae(r._callback,a,o,u,c),e.next=20,l.load();case 20:r._checkSessionIFrame=l,l.start(n),e.next=25;break;case 24:s.warn("no check session iframe found in the metadata");case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(8),s.error("Error from getCheckSessionIframe:",e.t0 instanceof Error?e.t0.message:e.t0);case 30:case"end":return e.stop()}}),e,null,[[8,27]])})));return function(t){return e.apply(this,arguments)}}(),this._stop=function(){var e=r._logger.create("_stop");if(r._sub=void 0,r._sid=void 0,r._checkSessionIFrame&&r._checkSessionIFrame.stop(),r._userManager.settings.monitorAnonymousSession)var t=setInterval(a(i().mark((function n(){var s,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return clearInterval(t),n.prev=1,n.next=4,r._userManager.querySessionStatus();case 4:(s=n.sent)&&(o={session_state:s.session_state,profile:s.sub&&s.sid?{sub:s.sub,sid:s.sid}:null},r._start(o)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),e.error("error from querySessionStatus",n.t0 instanceof Error?n.t0.message:n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])}))),1e3)},this._callback=a(i().mark((function e(){var t,n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r._logger.create("_callback"),e.prev=1,e.next=4,r._userManager.querySessionStatus();case 4:n=e.sent,s=!0,n&&r._checkSessionIFrame?n.sub===r._sub?(s=!1,r._checkSessionIFrame.start(n.session_state),n.sid===r._sid?t.debug("same sub still logged in at OP, restarting check session iframe; session_state",n.session_state):(t.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",n.session_state),r._userManager.events._raiseUserSessionChanged())):t.debug("different subject signed into OP",n.sub):t.debug("subject no longer signed into OP"),s?r._sub?r._userManager.events._raiseUserSignedOut():r._userManager.events._raiseUserSignedIn():t.debug("no change in session detected, no event to raise"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),r._sub&&(t.debug("Error calling queryCurrentSigninSession; raising signed out event",e.t0),r._userManager.events._raiseUserSignedOut());case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))),t||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch((function(e){r._logger.error(e)}))}return y(e,[{key:"_init",value:function(){var e=a(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.create("_init"),e.next=3,this._userManager.getUser();case 3:if(!(t=e.sent)){e.next=8;break}this._start(t),e.next=13;break;case 8:if(!this._userManager.settings.monitorAnonymousSession){e.next=13;break}return e.next=11,this._userManager.querySessionStatus();case 11:(r=e.sent)&&(n={session_state:r.session_state,profile:r.sub&&r.sid?{sub:r.sub,sid:r.sid}:null},this._start(n));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Pe=function(){function e(t){var r;_(this,e),this.id_token=t.id_token,this.session_state=null!=(r=t.session_state)?r:null,this.access_token=t.access_token,this.refresh_token=t.refresh_token,this.token_type=t.token_type,this.scope=t.scope,this.profile=t.profile,this.expires_at=t.expires_at,this.state=t.userState}return y(e,[{key:"expires_in",get:function(){if(void 0!==this.expires_at)return this.expires_at-re.getEpochTime()},set:function(e){void 0!==e&&(this.expires_at=Math.floor(e)+re.getEpochTime())}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}},{key:"toStorageString",value:function(){return new Y("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}}],[{key:"fromStorageString",value:function(t){return Y.createStatic("User","fromStorageString"),new e(JSON.parse(t))}}]),e}(),Oe="oidc-client",Ie=function(){function e(){_(this,e),this._abort=new X("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}return y(e,[{key:"navigate",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,a=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._logger.create("navigate"),this._window){e.next=3;break}throw new Error("Attempted to navigate on a disposed window");case 3:return r.debug("setting URL in window"),this._window.location.replace(t.url),e.next=7,new Promise((function(e,n){var i=function(i){var s,o=i.data,u=null!=(s=t.scriptOrigin)?s:window.location.origin;if(i.origin===u&&(null==o?void 0:o.source)===Oe){try{var c=ne.readParams(o.url,t.response_mode).get("state");if(c||r.warn("no state found in response url"),i.source!==a._window&&c!==t.state)return}catch(l){a._dispose(),n(new Error("Invalid response from window"))}e(o)}};window.addEventListener("message",i,!1),a._disposeHandlers.add((function(){return window.removeEventListener("message",i,!1)})),a._disposeHandlers.add(a._abort.addHandler((function(e){a._dispose(),n(e)})))}));case 7:return n=e.sent,s=n.url,o=n.keepOpen,r.debug("got response from window"),this._dispose(),o||this.close(),e.abrupt("return",{url:s});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_dispose",value:function(){this._logger.create("_dispose");var e,t=w(this._disposeHandlers);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(r){t.e(r)}finally{t.f()}this._disposeHandlers.clear()}}],[{key:"_notifyParent",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.location.origin;e.postMessage({source:Oe,url:t,keepOpen:r},n)}}]),e}(),Re={location:!1,toolbar:!1,height:640,closePopupWindowAfterInSeconds:-1},Ce="_blank",Ue=function(e){d(r,e);var t=p(r);function r(e){var n;_(this,r);var i=e.popup_redirect_uri,s=void 0===i?e.redirect_uri:i,o=e.popup_post_logout_redirect_uri,a=void 0===o?e.post_logout_redirect_uri:o,u=e.popupWindowFeatures,c=void 0===u?Re:u,l=e.popupWindowTarget,d=void 0===l?Ce:l,p=e.redirectMethod,f=void 0===p?"assign":p,h=e.redirectTarget,g=void 0===h?"self":h,v=e.iframeNotifyParentOrigin,y=void 0===v?e.iframeNotifyParentOrigin:v,w=e.iframeScriptOrigin,m=void 0===w?e.iframeScriptOrigin:w,k=e.silent_redirect_uri,x=void 0===k?e.redirect_uri:k,b=e.silentRequestTimeoutInSeconds,S=void 0===b?10:b,T=e.automaticSilentRenew,E=void 0===T||T,P=e.validateSubOnSilentRenew,O=void 0===P||P,I=e.includeIdTokenInSilentRenew,R=void 0!==I&&I,C=e.monitorSession,U=void 0!==C&&C,j=e.monitorAnonymousSession,M=void 0!==j&&j,A=e.checkSessionIntervalInSeconds,q=void 0===A?2:A,N=e.query_status_response_type,H=void 0===N?"code":N,W=e.stopCheckSessionOnError,L=void 0===W||W,F=e.revokeTokenTypes,B=void 0===F?["access_token","refresh_token"]:F,D=e.revokeTokensOnSignout,J=void 0!==D&&D,z=e.includeIdTokenInSilentSignout,K=void 0!==z&&z,Q=e.accessTokenExpiringNotificationTimeInSeconds,G=void 0===Q?60:Q,V=e.userStore;if((n=t.call(this,e)).popup_redirect_uri=s,n.popup_post_logout_redirect_uri=a,n.popupWindowFeatures=c,n.popupWindowTarget=d,n.redirectMethod=f,n.redirectTarget=g,n.iframeNotifyParentOrigin=y,n.iframeScriptOrigin=m,n.silent_redirect_uri=x,n.silentRequestTimeoutInSeconds=S,n.automaticSilentRenew=E,n.validateSubOnSilentRenew=O,n.includeIdTokenInSilentRenew=R,n.monitorSession=U,n.monitorAnonymousSession=M,n.checkSessionIntervalInSeconds=q,n.stopCheckSessionOnError=L,n.query_status_response_type=H,n.revokeTokenTypes=B,n.revokeTokensOnSignout=J,n.includeIdTokenInSilentSignout=K,n.accessTokenExpiringNotificationTimeInSeconds=G,V)n.userStore=V;else{var Y="undefined"!==typeof window?window.sessionStorage:new ue;n.userStore=new de({store:Y})}return n}return y(r)}(pe),je=function(e){d(r,e);var t=p(r);function r(e){var n,i=e.silentRequestTimeoutInSeconds,s=void 0===i?10:i;return _(this,r),(n=t.call(this))._logger=new Y("IFrameWindow"),n._timeoutInSeconds=s,n._frame=r.createHiddenIframe(),n._window=n._frame.contentWindow,n}return y(r,[{key:"navigate",value:function(){var e=a(i().mark((function e(t){var n,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds),n=setTimeout((function(){return s._abort.raise(new se("IFrame timed out without a response"))}),1e3*this._timeoutInSeconds),this._disposeHandlers.add((function(){return clearTimeout(n)})),e.next=5,f(h(r.prototype),"navigate",this).call(this,t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e,t=this;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",(function(e){var r,n=e.target;null==(r=n.parentNode)||r.removeChild(n),t._abort.raise(new Error("IFrame removed from DOM"))}),!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}}],[{key:"createHiddenIframe",value:function(){var e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",window.document.body.appendChild(e),e}},{key:"notifyParent",value:function(e,t){return f(h(r),"_notifyParent",this).call(this,window.parent,e,!1,t)}}]),r}(Ie),Me=function(){function e(t){_(this,e),this._settings=t,this._logger=new Y("IFrameNavigator")}return y(e,[{key:"prepare",value:function(){var e=a(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.silentRequestTimeoutInSeconds,n=void 0===r?this._settings.silentRequestTimeoutInSeconds:r,e.abrupt("return",new je({silentRequestTimeoutInSeconds:n}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"callback",value:function(){var e=a(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._logger.create("callback"),je.notifyParent(t,this._settings.iframeNotifyParentOrigin);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ae=function(e){d(r,e);var t=p(r);function r(e){var n,i=e.popupWindowTarget,o=void 0===i?Ce:i,a=e.popupWindowFeatures,u=void 0===a?{}:a;_(this,r),(n=t.call(this))._logger=new Y("PopupWindow");var c=te.center(s(s({},Re),u));return n._window=window.open(void 0,o,te.serialize(c)),u.closePopupWindowAfterInSeconds&&u.closePopupWindowAfterInSeconds>0&&setTimeout((function(){n._window&&"boolean"===typeof n._window.closed&&!n._window.closed?n.close():n._abort.raise(new Error("Popup blocked by user"))}),1e3*u.closePopupWindowAfterInSeconds),n}return y(r,[{key:"navigate",value:function(){var e=a(i().mark((function e(t){var n,s,o=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(n=this._window)||n.focus(),s=setInterval((function(){o._window&&!o._window.closed||o._abort.raise(new Error("Popup closed by user"))}),500),this._disposeHandlers.add((function(){return clearInterval(s)})),e.next=5,f(h(r.prototype),"navigate",this).call(this,t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}}],[{key:"notifyOpener",value:function(e,t){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return f(h(r),"_notifyParent",this).call(this,window.opener,e,t)}}]),r}(Ie),qe=function(){function e(t){_(this,e),this._settings=t,this._logger=new Y("PopupNavigator")}return y(e,[{key:"prepare",value:function(){var e=a(i().mark((function e(t){var r,n,s,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.popupWindowFeatures,n=void 0===r?this._settings.popupWindowFeatures:r,s=t.popupWindowTarget,o=void 0===s?this._settings.popupWindowTarget:s,e.abrupt("return",new Ae({popupWindowFeatures:n,popupWindowTarget:o}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"callback",value:function(){var e=a(i().mark((function e(t,r){var n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.keepOpen,s=void 0!==n&&n,this._logger.create("callback"),Ae.notifyOpener(t,s);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),Ne=function(){function e(t){_(this,e),this._settings=t,this._logger=new Y("RedirectNavigator")}return y(e,[{key:"prepare",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,u,c,l,d,p=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.redirectMethod,n=void 0===r?this._settings.redirectMethod:r,s=t.redirectTarget,o=void 0===s?this._settings.redirectTarget:s,this._logger.create("prepare"),c=window.self,"top"===o&&(c=null!=(u=window.top)?u:window.self),l=c.location[n].bind(c.location),e.abrupt("return",{navigate:function(){var e=a(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p._logger.create("navigate"),r=new Promise((function(e,t){d=t})),l(t.url),e.next=5,r;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),close:function(){p._logger.create("close"),null==d||d(new Error("Redirect aborted")),c.stop()}});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"callback",value:function(){var e=a(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),He=function(e){d(r,e);var t=p(r);function r(e){var n;return _(this,r),(n=t.call(this,{expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}))._logger=new Y("UserManagerEvents"),n._userLoaded=new X("User loaded"),n._userUnloaded=new X("User unloaded"),n._silentRenewError=new X("Silent renew error"),n._userSignedIn=new X("User signed in"),n._userSignedOut=new X("User signed out"),n._userSessionChanged=new X("User session changed"),n}return y(r,[{key:"load",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];f(h(r.prototype),"load",this).call(this,e),t&&this._userLoaded.raise(e)}},{key:"unload",value:function(){f(h(r.prototype),"unload",this).call(this),this._userUnloaded.raise()}},{key:"addUserLoaded",value:function(e){return this._userLoaded.addHandler(e)}},{key:"removeUserLoaded",value:function(e){return this._userLoaded.removeHandler(e)}},{key:"addUserUnloaded",value:function(e){return this._userUnloaded.addHandler(e)}},{key:"removeUserUnloaded",value:function(e){return this._userUnloaded.removeHandler(e)}},{key:"addSilentRenewError",value:function(e){return this._silentRenewError.addHandler(e)}},{key:"removeSilentRenewError",value:function(e){return this._silentRenewError.removeHandler(e)}},{key:"_raiseSilentRenewError",value:function(e){this._silentRenewError.raise(e)}},{key:"addUserSignedIn",value:function(e){return this._userSignedIn.addHandler(e)}},{key:"removeUserSignedIn",value:function(e){this._userSignedIn.removeHandler(e)}},{key:"_raiseUserSignedIn",value:function(){this._userSignedIn.raise()}},{key:"addUserSignedOut",value:function(e){return this._userSignedOut.addHandler(e)}},{key:"removeUserSignedOut",value:function(e){this._userSignedOut.removeHandler(e)}},{key:"_raiseUserSignedOut",value:function(){this._userSignedOut.raise()}},{key:"addUserSessionChanged",value:function(e){return this._userSessionChanged.addHandler(e)}},{key:"removeUserSessionChanged",value:function(e){this._userSessionChanged.removeHandler(e)}},{key:"_raiseUserSessionChanged",value:function(){this._userSessionChanged.raise()}}]),r}(oe),We=function(){function e(t){var r=this;_(this,e),this._userManager=t,this._logger=new Y("SilentRenewService"),this._isStarted=!1,this._retryTimer=new re("Retry Silent Renew"),this._tokenExpiring=a(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r._logger.create("_tokenExpiring"),e.prev=1,e.next=4,r._userManager.signinSilent();case 4:t.debug("silent token renewal successful"),e.next=15;break;case 7:if(e.prev=7,e.t0=e.catch(1),!(e.t0 instanceof se)){e.next=13;break}return t.warn("ErrorTimeout from signinSilent:",e.t0,"retry in 5s"),r._retryTimer.init(5),e.abrupt("return");case 13:t.error("Error from signinSilent:",e.t0),r._userManager.events._raiseSilentRenewError(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,7]])})))}return y(e,[{key:"start",value:function(){var e=a(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._logger.create("start"),this._isStarted){e.next=13;break}return this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring),e.prev=5,e.next=8,this._userManager.getUser();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),t.error("getUser error",e.t0);case 13:case"end":return e.stop()}}),e,this,[[5,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}}]),e}(),Le=y((function e(t,r){_(this,e),this.refresh_token=t.refresh_token,this.id_token=t.id_token,this.session_state=t.session_state,this.scope=t.scope,this.profile=t.profile,this.resource=r,this.data=t.state})),Fe=function(){function e(t,r,n,i){_(this,e),this._logger=new Y("UserManager"),this.settings=new Ue(t),this._client=new Te(t),this._redirectNavigator=null!=r?r:new Ne(this.settings),this._popupNavigator=null!=n?n:new qe(this.settings),this._iframeNavigator=null!=i?i:new Me(this.settings),this._events=new He(this.settings),this._silentRenewService=new We(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new Ee(this))}return y(e,[{key:"events",get:function(){return this._events}},{key:"metadataService",get:function(){return this._client.metadataService}},{key:"getUser",value:function(){var e=a(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._logger.create("getUser"),e.next=3,this._loadUser();case 3:if(!(r=e.sent)){e.next=8;break}return t.info("user loaded"),this._events.load(r,!1),e.abrupt("return",r);case 8:return t.info("user not found in storage"),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeUser",value:function(){var e=a(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._logger.create("removeUser"),e.next=3,this.storeUser(null);case 3:t.info("user removed from storage"),this._events.unload();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signinRedirect",value:function(){var e=a(i().mark((function e(){var t,r,n,a,u=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},this._logger.create("signinRedirect"),r=t.redirectMethod,n=o(t,T),e.next=5,this._redirectNavigator.prepare({redirectMethod:r});case 5:return a=e.sent,e.next=8,this._signinStart(s({request_type:"si:r"},n),a);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signinRedirectCallback",value:function(){var e=a(i().mark((function e(){var t,r,n,s=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:window.location.href,r=this._logger.create("signinRedirectCallback"),e.next=4,this._signinEnd(t);case 4:return(n=e.sent).profile&&n.profile.sub?r.info("success, signed in subject",n.profile.sub):r.info("no subject"),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signinResourceOwnerCredentials",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,a,u,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.username,n=t.password,s=t.skipUserInfo,o=void 0!==s&&s,a=this._logger.create("signinResourceOwnerCredential"),e.next=4,this._client.processResourceOwnerPasswordCredentials({username:r,password:n,skipUserInfo:o,extraTokenParams:this.settings.extraTokenParams});case 4:return u=e.sent,a.debug("got signin response"),e.next=8,this._buildUser(u);case 8:return(c=e.sent).profile&&c.profile.sub?a.info("success, signed in subject",c.profile.sub):a.info("no subject"),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signinPopup",value:function(){var e=a(i().mark((function e(){var t,r,n,a,u,c,l,d,p=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},r=this._logger.create("signinPopup"),n=t.popupWindowFeatures,a=t.popupWindowTarget,u=o(t,E),(c=this.settings.popup_redirect_uri)||r.throw(new Error("No popup_redirect_uri configured")),e.next=7,this._popupNavigator.prepare({popupWindowFeatures:n,popupWindowTarget:a});case 7:return l=e.sent,e.next=10,this._signin(s({request_type:"si:p",redirect_uri:c,display:"popup"},u),l);case 10:return(d=e.sent)&&(d.profile&&d.profile.sub?r.info("success, signed in subject",d.profile.sub):r.info("no subject")),e.abrupt("return",d);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signinPopupCallback",value:function(){var e=a(i().mark((function e(){var t,r,n,s=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:window.location.href,r=s.length>1&&void 0!==s[1]&&s[1],n=this._logger.create("signinPopupCallback"),e.next=5,this._popupNavigator.callback(t,{keepOpen:r});case 5:n.info("success");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signinSilent",value:function(){var e=a(i().mark((function e(){var t,r,n,a,u,c,l,d,p,f,h,g=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.length>0&&void 0!==g[0]?g[0]:{},n=this._logger.create("signinSilent"),a=t.silentRequestTimeoutInSeconds,u=t.resource,c=o(t,P),e.next=5,this._loadUser();case 5:if(!(null==(l=e.sent)?void 0:l.refresh_token)){e.next=12;break}return n.debug("using refresh token"),d=new Le(l,u),e.next=11,this._useRefreshToken(d);case 11:return e.abrupt("return",e.sent);case 12:return(p=this.settings.silent_redirect_uri)||n.throw(new Error("No silent_redirect_uri configured")),l&&this.settings.validateSubOnSilentRenew&&(n.debug("subject prior to silent renew:",l.profile.sub),f=l.profile.sub),e.next=17,this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:a});case 17:return h=e.sent,e.next=20,this._signin(s({request_type:"si:s",redirect_uri:p,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==l?void 0:l.id_token:void 0},c),h,f);case 20:return(l=e.sent)&&((null==(r=l.profile)?void 0:r.sub)?n.info("success, signed in subject",l.profile.sub):n.info("no subject")),e.abrupt("return",l);case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_useRefreshToken",value:function(){var e=a(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client.useRefreshToken({state:t,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds});case 2:return r=e.sent,n=new Pe(s(s({},t),r)),e.next=6,this.storeUser(n);case 6:return this._events.load(n),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signinSilentCallback",value:function(){var e=a(i().mark((function e(){var t,r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:window.location.href,r=this._logger.create("signinSilentCallback"),e.next=4,this._iframeNavigator.callback(t);case 4:r.info("success");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signinCallback",value:function(){var e=a(i().mark((function e(){var t,r,n,s=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:window.location.href,e.next=3,this._client.readSigninResponseState(t);case 3:r=e.sent,n=r.state,e.t0=n.request_type,e.next="si:r"===e.t0?8:"si:p"===e.t0?11:"si:s"===e.t0?14:17;break;case 8:return e.next=10,this.signinRedirectCallback(t);case 10:case 13:case 16:return e.abrupt("return",e.sent);case 11:return e.next=13,this.signinPopupCallback(t);case 14:return e.next=16,this.signinSilentCallback(t);case 17:throw new Error("invalid response_type in state");case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signoutCallback",value:function(){var e=a(i().mark((function e(){var t,r,n,s,o=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:window.location.href,r=o.length>1&&void 0!==o[1]&&o[1],e.next=4,this._client.readSignoutResponseState(t);case 4:if(n=e.sent,s=n.state){e.next=8;break}return e.abrupt("return");case 8:e.t0=s.request_type,e.next="so:r"===e.t0?11:"so:p"===e.t0?14:"so:s"===e.t0?17:20;break;case 11:return e.next=13,this.signoutRedirectCallback(t);case 13:case 16:case 19:return e.abrupt("break",21);case 14:return e.next=16,this.signoutPopupCallback(t,r);case 17:return e.next=19,this.signoutSilentCallback(t);case 20:throw new Error("invalid response_type in state");case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"querySessionStatus",value:function(){var e=a(i().mark((function e(){var t,r,n,a,u,c,l,d,p,f=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:{},r=this._logger.create("querySessionStatus"),n=t.silentRequestTimeoutInSeconds,a=o(t,O),(u=this.settings.silent_redirect_uri)||r.throw(new Error("No silent_redirect_uri configured")),e.next=7,this._loadUser();case 7:return c=e.sent,e.next=10,this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});case 10:return l=e.sent,e.next=13,this._signinStart(s({request_type:"si:s",redirect_uri:u,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==c?void 0:c.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0},a),l);case 13:return d=e.sent,e.prev=14,e.next=17,this._client.processSigninResponse(d.url);case 17:if(p=e.sent,r.debug("got signin response"),!p.session_state||!p.profile.sub){e.next=22;break}return r.info("success for subject",p.profile.sub),e.abrupt("return",{session_state:p.session_state,sub:p.profile.sub,sid:p.profile.sid});case 22:return r.info("success, user not authenticated"),e.abrupt("return",null);case 26:if(e.prev=26,e.t0=e.catch(14),!(this.settings.monitorAnonymousSession&&e.t0 instanceof ie)){e.next=34;break}e.t1=e.t0.error,e.next="login_required"===e.t1||"consent_required"===e.t1||"interaction_required"===e.t1||"account_selection_required"===e.t1?32:34;break;case 32:return r.info("success for anonymous user"),e.abrupt("return",{session_state:e.t0.session_state});case 34:throw e.t0;case 35:case"end":return e.stop()}}),e,this,[[14,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"_signin",value:function(){var e=a(i().mark((function e(t,r,n){var s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._signinStart(t,r);case 2:return s=e.sent,e.next=5,this._signinEnd(s.url,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_signinStart",value:function(){var e=a(i().mark((function e(t,r){var n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("_signinStart"),e.prev=1,e.next=4,this._client.createSigninRequest(t);case 4:return s=e.sent,n.debug("got signin request"),e.next=8,r.navigate({url:s.url,state:s.state.id,response_mode:s.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin});case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(1),n.debug("error after preparing navigator, closing navigator window"),r.close(),e.t0;case 16:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_signinEnd",value:function(){var e=a(i().mark((function e(t,r){var n,s,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._logger.create("_signinEnd"),e.next=3,this._client.processSigninResponse(t);case 3:return s=e.sent,n.debug("got signin response"),e.next=7,this._buildUser(s,r);case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_buildUser",value:function(){var e=a(i().mark((function e(t,r){var n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._logger.create("_buildUser"),o=new Pe(t),!r){e.next=7;break}if(r===o.profile.sub){e.next=6;break}throw n.debug("current user does not match user returned from signin. sub from signin:",o.profile.sub),new ie(s(s({},t),{},{error:"login_required"}));case 6:n.debug("current user matches user returned from signin");case 7:return e.next=9,this.storeUser(o);case 9:return n.debug("user stored"),this._events.load(o),e.abrupt("return",o);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"signoutRedirect",value:function(){var e=a(i().mark((function e(){var t,r,n,a,u,c=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=this._logger.create("signoutRedirect"),n=t.redirectMethod,a=o(t,I),e.next=5,this._redirectNavigator.prepare({redirectMethod:n});case 5:return u=e.sent,e.next=8,this._signoutStart(s({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri},a),u);case 8:r.info("success");case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signoutRedirectCallback",value:function(){var e=a(i().mark((function e(){var t,r,n,s=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:window.location.href,r=this._logger.create("signoutRedirectCallback"),e.next=4,this._signoutEnd(t);case 4:return n=e.sent,r.info("success"),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signoutPopup",value:function(){var e=a(i().mark((function e(){var t,r,n,a,u,c,l,d=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},r=this._logger.create("signoutPopup"),n=t.popupWindowFeatures,a=t.popupWindowTarget,u=o(t,R),c=this.settings.popup_post_logout_redirect_uri,e.next=6,this._popupNavigator.prepare({popupWindowFeatures:n,popupWindowTarget:a});case 6:return l=e.sent,e.next=9,this._signout(s({request_type:"so:p",post_logout_redirect_uri:c,state:null==c?void 0:{}},u),l);case 9:r.info("success");case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signoutPopupCallback",value:function(){var e=a(i().mark((function e(){var t,r,n,s=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:window.location.href,r=s.length>1&&void 0!==s[1]&&s[1],n=this._logger.create("signoutPopupCallback"),e.next=5,this._popupNavigator.callback(t,{keepOpen:r});case 5:n.info("success");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_signout",value:function(){var e=a(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._signoutStart(t,r);case 2:return n=e.sent,e.next=5,this._signoutEnd(n.url);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_signoutStart",value:function(){var e=a(i().mark((function e(){var t,r,n,s,o,a,u,c=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=c.length>1?c[1]:void 0,s=this._logger.create("_signoutStart"),e.prev=3,e.next=6,this._loadUser();case 6:if(o=e.sent,s.debug("loaded current user from storage"),!this.settings.revokeTokensOnSignout){e.next=11;break}return e.next=11,this._revokeInternal(o);case 11:return(a=t.id_token_hint||o&&o.id_token)&&(s.debug("setting id_token_hint in signout request"),t.id_token_hint=a),e.next=15,this.removeUser();case 15:return s.debug("user removed, creating signout request"),e.next=18,this._client.createSignoutRequest(t);case 18:return u=e.sent,s.debug("got signout request"),e.next=22,r.navigate({url:u.url,state:null==(n=u.state)?void 0:n.id,scriptOrigin:this.settings.iframeScriptOrigin});case 22:return e.abrupt("return",e.sent);case 25:throw e.prev=25,e.t0=e.catch(3),s.debug("error after preparing navigator, closing navigator window"),r.close(),e.t0;case 30:case"end":return e.stop()}}),e,this,[[3,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"_signoutEnd",value:function(){var e=a(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._logger.create("_signoutEnd"),e.next=3,this._client.processSignoutResponse(t);case 3:return n=e.sent,r.debug("got signout response"),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signoutSilent",value:function(){var e=a(i().mark((function e(){var t,r,n,a,u,c,l,d,p=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p.length>0&&void 0!==p[0]?p[0]:{},n=this._logger.create("signoutSilent"),a=t.silentRequestTimeoutInSeconds,u=o(t,C),!this.settings.includeIdTokenInSilentSignout){e.next=15;break}return e.next=6,this._loadUser();case 6:if(e.t1=r=e.sent,null!=e.t1){e.next=11;break}e.t2=void 0,e.next=12;break;case 11:e.t2=r.id_token;case 12:e.t0=e.t2,e.next=16;break;case 15:e.t0=void 0;case 16:return c=e.t0,l=this.settings.popup_post_logout_redirect_uri,e.next=20,this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:a});case 20:return d=e.sent,e.next=23,this._signout(s({request_type:"so:s",post_logout_redirect_uri:l,id_token_hint:c},u),d);case 23:n.info("success");case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signoutSilentCallback",value:function(){var e=a(i().mark((function e(){var t,r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:window.location.href,r=this._logger.create("signoutSilentCallback"),e.next=4,this._iframeNavigator.callback(t);case 4:r.info("success");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"revokeTokens",value:function(){var e=a(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadUser();case 2:return r=e.sent,e.next=5,this._revokeInternal(r,t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_revokeInternal",value:function(){var e=a(i().mark((function e(t){var r,n,s,o,a,u,c=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:this.settings.revokeTokenTypes,n=this._logger.create("_revokeInternal"),t){e.next=4;break}return e.abrupt("return");case 4:if(s=r.filter((function(e){return"string"===typeof t[e]})),s.length){e.next=8;break}return n.debug("no need to revoke due to no token(s)"),e.abrupt("return");case 8:o=w(s),e.prev=9,o.s();case 11:if((a=o.n()).done){e.next=19;break}return u=a.value,e.next=15,this._client.revokeToken(t[u],u);case 15:n.info("".concat(u," revoked successfully")),"access_token"!==u&&(t[u]=null);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),o.e(e.t0);case 24:return e.prev=24,o.f(),e.finish(24);case 27:return e.next=29,this.storeUser(t);case 29:n.debug("user stored"),this._events.load(t);case 31:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"startSilentRenew",value:function(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}},{key:"stopSilentRenew",value:function(){this._silentRenewService.stop()}},{key:"_userStoreKey",get:function(){return"user:".concat(this.settings.authority,":").concat(this.settings.client_id)}},{key:"_loadUser",value:function(){var e=a(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._logger.create("_loadUser"),e.next=3,this.settings.userStore.get(this._userStoreKey);case 3:if(!(r=e.sent)){e.next=7;break}return t.debug("user storageString loaded"),e.abrupt("return",Pe.fromStorageString(r));case 7:return t.debug("no user storageString"),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"storeUser",value:function(){var e=a(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._logger.create("storeUser"),!t){e.next=8;break}return r.debug("storing user"),n=t.toStorageString(),e.next=6,this.settings.userStore.set(this._userStoreKey,n);case 6:e.next=11;break;case 8:return this._logger.debug("removing user"),e.next=11,this.settings.userStore.remove(this._userStoreKey);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearStaleState",value:function(){var e=a(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client.clearStaleState();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Be="2.3.0"},6941:function(e,t,r){"use strict";t.t5=void 0;var n=r(6972);var i=r(3586);Object.defineProperty(t,"t5",{enumerable:!0,get:function(){return i.decodeJwt}})},2152:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__read||function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.assert=t.AssertionError=void 0;var s=r(9604),o=r(9089),a=function(e){function t(t){var r=this.constructor,n=e.call(this,"Wrong assertion encountered"+(t?': "'.concat(t,'"'):""))||this;if(Object.setPrototypeOf(n,r.prototype),!n.stack)return n;try{(0,s.overwriteReadonlyProp)(n,"stack",n.stack.split("\n").filter((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=i(e,2)[1];return 1!==r&&2!==r})).join("\n"))}catch(o){}return n}return n(t,e),t}(Error);t.AssertionError=a,t.assert=function(e,t){if(0===arguments.length&&(e=!0),void 0===o.assertIsRefWrapper.ref){if(!e)throw new a(t)}else o.assertIsRefWrapper.ref=void 0}},9953:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.id=void 0;t.id=function(e){return e}},8653:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.is=void 0;var n=r(9089),i=["Wrong usage of the ".concat(s.name," function refer to"),"https://docs.tsafe.dev/".concat(s.name.toLowerCase())].join(" ");function s(e){var t={};if(void 0!==n.assertIsRefWrapper.ref)throw n.assertIsRefWrapper.ref=void 0,new Error(i);return n.assertIsRefWrapper.ref=t,Promise.resolve().then((function(){if(n.assertIsRefWrapper.ref===t)throw new Error(i)})),null}t.is=s},9604:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.overwriteReadonlyProp=void 0;var i=r(2152),s=r(8653);t.overwriteReadonlyProp=function(e,t,r){try{e[t]=r}catch(u){}if(e[t]===r)return r;var o=void 0,a=Object.getOwnPropertyDescriptor(e,t)||{enumerable:!0,configurable:!0};if(a.get)throw new Error("Probably a wrong ides to overwrite ".concat(String(t)," getter"));try{Object.defineProperty(e,t,n(n({},a),{value:r}))}catch(c){(0,i.assert)((0,s.is)(c)),o=c}if(e[t]!==r)throw o||new Error("Can't assign");return r}},9089:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertIsRefWrapper=void 0;var n=r(9953);t.assertIsRefWrapper={ref:(0,n.id)(void 0)}},6972:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{u(n.next(e))}catch(t){s(t)}}function a(e){try{u(n.throw(e))}catch(t){s(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(u){a=[6,u],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__read||function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},a=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},u=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.createOidc=void 0;var c=r(7187),l=r(9953),d=r(8187),p=r(2152),f=r(57),h=r(7625),g=r(2452),v=["code","state","session_state"];function _(e){var t=e.access_token,r=function(){var r=e.expires_at;if(void 0!==r)return 1e3*r;var n=(0,d.readExpirationTimeInJwt)(t);if(void 0!==n)return n;(0,p.assert)(!1,"Failed to get access token expiration time")}(),n=e.refresh_token;(0,p.assert)(void 0!==n,"No refresh token provided by the oidc server");var i=function(){var e=(0,d.readExpirationTimeInJwt)(n);if(void 0!==e)return e;(0,p.assert)(!1,"Failed to get refresh token expiration time")}(),s=e.id_token;return(0,p.assert)(void 0!==s,"No id token provided by the oidc server"),{accessToken:t,accessTokenExpirationTime:r,refreshToken:n,refreshTokenExpirationTime:i,idToken:s}}t.createOidc=function(e){return i(this,void 0,void 0,(function(){var t,r,d,y,w,m,k,x,b,S,T,E,P,O,I=this;return s(this,(function(R){switch(R.label){case 0:return t=e.issuerUri,r=e.clientId,d=e.transformUrlBeforeRedirect,y=void 0===d?function(e){return e}:d,w=e.getExtraQueryParams,m=e.publicUrl,k=void 0===m?window.location.origin:m.startsWith("http")?m.replace(/\/$/,""):"".concat(window.location.origin).concat(m),x=(0,h.fnv1aHashToHex)("".concat(t," ").concat(r)),b="configHash",S=new c.UserManager({authority:t,client_id:r,redirect_uri:"",response_type:"code",scope:"openid profile",automaticSilentRenew:!1,silent_redirect_uri:"".concat(k,"/silent-sso.html?").concat(b,"=").concat(x)}),T=function(e){var t=e.doesCurrentHrefRequiresAuth,r=e.extraQueryParams;return i(I,void 0,void 0,(function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var s=new(i.bind.apply(i,a([void 0],o(e),!1)));return new Proxy(s,{get:function(e,t){if("href"===t){var i=s.href;return Object.entries(n(n({},null===w||void 0===w?void 0:w()),r)).forEach((function(e){var t=o(e,2),r=t[0],n=t[1];return i=(0,f.addQueryParamToUrl)({url:i,name:r,value:n}).newUrl})),i=y(i)}return e[t]}})}var i,u;return s(this,(function(r){switch(r.label){case 0:return i=window.URL,Object.defineProperty(window,"URL",{value:e}),u=(0,f.addQueryParamToUrl)({url:window.location.href,name:b,value:x}).newUrl,[4,S.signinRedirect({redirect_uri:u,redirectMethod:t?"replace":"assign"})];case 1:return r.sent(),[2,new Promise((function(){}))]}}))}))},[4,function(){return i(this,void 0,void 0,(function(){var e,t,n,i,o,a,c,l,d,h,_,y;return s(this,(function(s){switch(s.label){case 0:if(e=window.location.href,!(o=(0,f.retrieveQueryParamFromUrl)({name:b,url:e})).wasPresent||o.value!==x)return[3,5];if(e=o.newUrl,(o=(0,f.retrieveQueryParamFromUrl)({name:"error",url:e})).wasPresent)throw new Error("OIDC error: ".concat(o.value));d="https://dummy.com";try{for(t=u(v),n=t.next();!n.done;n=t.next())i=n.value,o=(0,f.retrieveQueryParamFromUrl)({name:i,url:e}),(0,p.assert)(o.wasPresent),d=(0,f.addQueryParamToUrl)({url:d,name:i,value:o.value}).newUrl,e=o.newUrl}catch(w){_={error:w}}finally{try{n&&!n.done&&(y=t.return)&&y.call(t)}finally{if(_)throw _.error}}window.history.pushState(null,"",e),h=void 0,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,S.signinRedirectCallback(d)];case 2:return h=s.sent(),[3,4];case 3:return s.sent(),[2,void 0];case 4:return[2,h];case 5:return[4,S.getUser()];case 6:if(null===(h=s.sent()))return[3,11];s.label=7;case 7:return s.trys.push([7,9,,10]),[4,S.signinSilent()];case 8:return s.sent(),[3,10];case 9:return s.sent(),[2,void 0];case 10:return[2,h];case 11:return a=new g.Deferred,c=setTimeout((function(){return a.reject(new Error("SSO silent login timeout with clientId: ".concat(r)))}),5e3),l=function(e){var t,r;if(e.origin===window.location.origin&&"string"===typeof e.data){var n=e.data,i=void 0;try{i=(0,f.retrieveQueryParamFromUrl)({name:b,url:n})}catch(R){return}if(i.wasPresent&&i.value===x)if(clearTimeout(c),window.removeEventListener("message",l),(i=(0,f.retrieveQueryParamFromUrl)({name:"error",url:n})).wasPresent)a.resolve(void 0);else{var s="https://dummy.com";try{for(var o=u(v),d=o.next();!d.done;d=o.next()){var h=d.value;i=(0,f.retrieveQueryParamFromUrl)({name:h,url:n});(0,p.assert)(i.wasPresent),s=(0,f.addQueryParamToUrl)({url:s,name:h,value:i.value}).newUrl}}catch(g){t={error:g}}finally{try{d&&!d.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}a.resolve(s)}}},window.addEventListener("message",l,!1),S.signinSilent({silentRequestTimeoutInSeconds:1}).catch((function(){})),[4,a.pr];case 12:return void 0===(d=s.sent())?[3,14]:[4,S.signinRedirectCallback(d)];case 13:return[2,h=s.sent()];case 14:return[2,void 0]}}))}))}().then((function(e){if(void 0!==e){var n=_(e);return n.refreshTokenExpirationTime<n.accessTokenExpirationTime&&console.warn(["The OIDC refresh token shorter than the one of the access token.","This is very unusual and probably a misconfiguration.","Check your oidc server configuration for ".concat(r," ").concat(t)].join(" ")),n}}))];case 1:return E=R.sent(),P={params:{issuerUri:t,clientId:r}},void 0===E?[2,(0,l.id)(n(n({},P),{isUserLoggedIn:!1,login:T}))]:(O=(0,l.id)(n(n({},P),{isUserLoggedIn:!0,getTokens:function(){return{accessToken:E.accessToken,idToken:E.idToken,refreshToken:E.refreshToken,refreshTokenExpirationTime:E.refreshTokenExpirationTime,accessTokenExpirationTime:E.accessTokenExpirationTime}},logout:function(e){return i(I,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,S.signoutRedirect({post_logout_redirect_uri:function(){switch(e.redirectTo){case"current page":return window.location.href;case"home":return k;case"specific url":return e.url}(0,p.assert)(!1)}()})];case 1:return t.sent(),[2,new Promise((function(){}))]}}))}))},renewTokens:function(){return i(I,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,S.signinSilent()];case 1:return e=t.sent(),(0,p.assert)(null!==e),Object.assign(E,_(e)),[2]}}))}))}})),function e(){var t=this,r=Math.min(E.accessTokenExpirationTime,E.refreshTokenExpirationTime)-Date.now();setTimeout((function(){return i(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),[4,O.renewTokens()];case 1:case 3:return t.sent(),[3,4];case 2:return t.sent(),[4,T({doesCurrentHrefRequiresAuth:!0})];case 4:return e(),[2]}}))}))}),r-25e3)}(),[2,O])}}))}))}},9243:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__read||function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.useOidc=t.createOidcProvider=void 0;var s=r(184),o=r(2791),a=r(6972),u=r(2152),c=(0,o.createContext)(void 0);t.createOidcProvider=function(e){var t=(0,a.createOidc)(e);return{OidcProvider:function(e){var r=e.children,a=e.fallback,u=i((0,o.useState)(void 0),2),l=u[0],d=u[1];return(0,o.useEffect)((function(){t.then(d)}),[]),void 0===l?(0,s.jsx)(s.Fragment,{children:void 0===a?null:a}):(0,s.jsx)(c.Provider,n({value:l},{children:r}))}}},t.useOidc=function(){var e=(0,o.useContext)(c);return(0,u.assert)(void 0!==e,"You must use useOidc inside a OidcClientProvider"),{oidc:e}}},2452:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.VoidDeferred=t.Deferred=void 0;var i=r(9604),s=function(){var e,t,r=this;this.isPending=!0,this.pr=new Promise((function(n,s){e=function(e){(0,i.overwriteReadonlyProp)(r,"isPending",!1),n(e)},t=function(e){(0,i.overwriteReadonlyProp)(r,"isPending",!1),s(e)}})),this.resolve=e,this.reject=t};t.Deferred=s;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(s);t.VoidDeferred=o},3586:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeJwt=void 0;var i=n(r(456));t.decodeJwt=i.default},7625:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1aHashToHex=void 0,t.fnv1aHashToHex=function(e){for(var t=2166136261,r=0;r<e.length;r++)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return(t>>>0).toString(16)}},8187:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.readExpirationTimeInJwt=void 0;var i=n(r(456)),s=r(2152);t.readExpirationTimeInJwt=function(e){var t;try{t=1e3*(0,i.default)(e).exp,(0,s.assert)("number"===typeof t&&!isNaN(t))}catch(r){return}return t}},57:function(e,t){"use strict";var r=this&&this.__read||function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o};function n(e){var t=e.url,n=e.prefix,i=e.doLeavePrefixInResults,s=r(t.split("?"),2),o=s[0],a=s[1],u=void 0===a?"":a,c={},l=function(){var e=u.replace(/^\?/,"").split("&").map((function(e){return e.split("=")})).filter((function(e){var t=r(e,2),s=t[0],o=t[1];return!s.startsWith(n)||(c[i?s:s.substring(n.length)]=decodeURIComponent(o),!1)})).map((function(e){return e.join("=")})).join("&");return{newLocationSearch:e=""===e?"":"?".concat(e)}}().newLocationSearch;return{newUrl:"".concat(o).concat(l),values:c}}function i(e){var t=e.url,r=e.name,i=n({url:t,prefix:r,doLeavePrefixInResults:!0}),s=i.newUrl,o=i.values;return r in o?{wasPresent:!0,newUrl:s,value:o[r]}:{wasPresent:!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveQueryParamFromUrl=t.retrieveAllQueryParamStartingWithPrefixFromUrl=t.addQueryParamToUrl=void 0,t.addQueryParamToUrl=function(e){var t=e.url,r=e.name,n=e.value,s=t,o=i({url:t,name:r});return o.wasPresent&&(s=o.newUrl),{newUrl:s+="".concat(s.includes("?")?"&":s.endsWith("?")?"":"?").concat(r,"=").concat(encodeURIComponent(n))}},t.retrieveAllQueryParamStartingWithPrefixFromUrl=n,t.retrieveQueryParamFromUrl=i},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,r){var n=r(3897);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},7156:function(e){function t(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(c){return void r(c)}a.done?t(u):Promise.resolve(u).then(n,i)}e.exports=function(e){return function(){var r=this,n=arguments;return new Promise((function(i,s){var o=e.apply(r,n);function a(e){t(o,i,s,a,u,"next",e)}function u(e){t(o,i,s,a,u,"throw",e)}a(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,r){var n=r(6015),i=r(9617);function s(t,r,o){return i()?(e.exports=s=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=s=function(e,t,r){var i=[null];i.push.apply(i,t);var s=new(Function.bind.apply(e,i));return r&&n(s,r.prototype),s},e.exports.__esModule=!0,e.exports.default=e.exports),s.apply(null,arguments)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,r){var n=r(4062);function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}e.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,r){var n=r(6116);e.exports=function(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,r){var n=r(3808),i=r(9617),s=r(4993);e.exports=function(e){var t=i();return function(){var r,i=n(e);if(t){var o=n(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return s(this,r)}},e.exports.__esModule=!0,e.exports.default=e.exports},8416:function(e,t,r){var n=r(4062);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},1588:function(e,t,r){var n=r(1753);function i(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,r){var i=n(e,t);if(i){var s=Object.getOwnPropertyDescriptor(i,t);return s.get?s.get.call(arguments.length<3?e:r):s.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,r){var n=r(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},6035:function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,s,o,a=[],u=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=s.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(l){c=!0,i=l}finally{try{if(!u&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},3012:function(e){e.exports=function(e){if(null==e)throw new TypeError("Cannot destructure "+e)},e.exports.__esModule=!0,e.exports.default=e.exports},2122:function(e,t,r){var n=r(8416);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},215:function(e,t,r){var n=r(7071);e.exports=function(e,t){if(null==e)return{};var r,i,s=n(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s},e.exports.__esModule=!0,e.exports.default=e.exports},7071:function(e){e.exports=function(e,t){if(null==e)return{};var r,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(i[r]=e[r]);return i},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,r){var n=r(8698).default,i=r(6115);e.exports=function(e,t){if(t&&("object"===n(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,r){var n=r(8698).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,s=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(C){d=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof g?t:g,s=Object.create(i.prototype),a=new O(n||[]);return o(s,"_invoke",{value:S(e,r,a)}),s}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(C){return{type:"throw",arg:C}}}t.wrap=p;var h={};function g(){}function v(){}function _(){}var y={};d(y,u,(function(){return this}));var w=Object.getPrototypeOf,m=w&&w(w(I([])));m&&m!==r&&s.call(m,u)&&(y=m);var k=_.prototype=g.prototype=Object.create(y);function x(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function r(i,o,a,u){var c=f(e[i],e,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==n(d)&&s.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,u)}),(function(e){r("throw",e,a,u)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function s(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(s,s):s()}})}function S(e,t,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return R()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=T(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=f(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function T(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function I(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(s.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:R}}function R(){return{value:void 0,done:!0}}return v.prototype=_,o(k,"constructor",{value:_,configurable:!0}),o(_,"constructor",{value:v,configurable:!0}),v.displayName=d(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,d(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(b.prototype),d(b.prototype,c,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new b(p(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},x(k),d(k,l,"Generator"),d(k,u,(function(){return this})),d(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=s.call(i,"catchLoc"),u=s.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:I(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,r){var n=r(5372),i=r(8872),s=r(6116),o=r(2218);e.exports=function(e,t){return n(e)||i(e,t)||s(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},1753:function(e,t,r){var n=r(3808);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,r){var n=r(3405),i=r(9498),s=r(6116),o=r(2281);e.exports=function(e){return n(e)||i(e)||s(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,r){var n=r(8698).default;e.exports=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,r){var n=r(8698).default,i=r(5036);e.exports=function(e){var t=i(e,"string");return"symbol"===n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,r){var n=r(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},3496:function(e,t,r){var n=r(3808),i=r(6015),s=r(6035),o=r(3515);function a(t){var r="function"===typeof Map?new Map:void 0;return e.exports=a=function(e){if(null===e||!s(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return o(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports}}]);
//# sourceMappingURL=1347.22b584ae.chunk.js.map
